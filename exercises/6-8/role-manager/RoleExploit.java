import java.util.List;

/**
 * EXPLOIT: RoleExploit
 * Bypasses UserRoleManager's restrictions by modifying the leaked internal
 * list.
 */
public class RoleExploit {
    public static void escalatePrivileges(UserRoleManager manager) {
        System.out.println("Exploit: Attempting to gain ADMIN access...");

        // The manager's addRole() blocks "ADMIN", but getRoles() gives us the list!
        List<String> leakedRoles = manager.getRoles();

        // Add ADMIN directly to the internal list, bypassing the check in addRole()
        leakedRoles.add("ADMIN");

        System.out.println("Exploit: Privilege escalation complete.");
    }
}
