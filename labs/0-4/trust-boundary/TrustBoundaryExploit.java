/**
 * TrustBoundaryExploit.java
 * 
 * This class demonstrates how an attacker can exploit the lack of trust
 * boundaries
 * to perform unauthorized actions (Path Traversal).
 */
public class TrustBoundaryExploit {
    public static void main(String[] args) {
        System.out.println("=== Lab 0-4: Establish Trust Boundaries ===\n");

        VulnerableTrustBoundary vulnerableService = new VulnerableTrustBoundary();
        SecureTrustBoundary secureService = new SecureTrustBoundary();

        // 1. Legitimate request
        String normalFile = "user_data.txt";
        System.out.println("[Step 1] Sending legitimate request: " + normalFile);
        vulnerableService.processDataFile(normalFile);

        // 2. Malicious request (Path Traversal)
        String maliciousFile = "../../etc/passwd";
        System.out.println("[Step 2] Sending malicious request to Vulnerable Service: " + maliciousFile);
        vulnerableService.processDataFile(maliciousFile);

        // 3. Attempting the same exploit on the Secure Service
        System.out.println("[Step 3] Sending malicious request to Secure Service: " + maliciousFile);
        try {
            secureService.processDataFile(maliciousFile);
        } catch (Exception e) {
            System.out.println("CAUGHT EXCEPTION: " + e.getMessage());
            System.out.println("The Secure Service successfully blocked the trust boundary violation.");
        }
    }
}
