/**
 * SQLInjectionExploit.java
 * 
 * This class demonstrates a classic SQL Injection attack.
 */
public class SQLInjectionExploit {
    public static void main(String[] args) {
        System.out.println("=== Lab 3-2: Avoid Dynamic SQL (SQL Injection) ===\n");

        VulnerableSearchService vulnerableService = new VulnerableSearchService();
        SecureSearchService secureService = new SecureSearchService();

        // 1. Legitimate search
        String normalUser = "bob";
        System.out.println("[Step 1] Normal search for user: " + normalUser);
        vulnerableService.searchUser(normalUser);

        // 2. Malicious search (SQL Injection)
        // This payload 'admin' OR '1'='1' makes the WHERE clause always true.
        String maliciousUser = "admin' OR '1'='1";
        System.out.println("[Step 2] Malicious search (SQL Injection): " + maliciousUser);
        vulnerableService.searchUser(maliciousUser);

        // 3. Secure search using Parameterized Query
        System.out.println("[Step 3] Secure search for the same malicious input: " + maliciousUser);
        secureService.searchUser(maliciousUser);
    }
}
