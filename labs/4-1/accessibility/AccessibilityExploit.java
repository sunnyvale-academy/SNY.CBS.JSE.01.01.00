/**
 * AccessibilityExploit.java
 * 
 * This class demonstrates how an attacker can leverage poorly restricted
 * accessibility to tamper with sensitive application state.
 */
public class AccessibilityExploit {
    public static void main(String[] args) {
        System.out.println("=== Lab 4-1: Limit Accessibility ===\n");

        VulnerableBankConfig vulnerableConfig = new VulnerableBankConfig();
        SecureBankConfig secureConfig = new SecureBankConfig();

        // 1. Exploit the vulnerable service
        System.out.println("[Step 1] Exploiting Vulnerable Service...");
        System.out.println("Current Interest Rate: " + vulnerableConfig.interestRate);

        // Direct modification of a public field
        vulnerableConfig.interestRate = 0.99;
        System.out.println("Modified Interest Rate: " + vulnerableConfig.interestRate);

        // Unauthorized call to an internal reset method
        vulnerableConfig.resetToDefault();

        System.out.println("\n--------------------------------------------------\n");

        // 2. Attempt the same on the Secure Service
        System.out.println("[Step 2] Attempting to exploit Secure Service...");

        // System.out.println(secureConfig.interestRate); // ERROR: interestRate has
        // private access
        System.out.println("Current Interest Rate (via getter): " + secureConfig.getInterestRate());

        System.out.println("\nNOTE: In the Secure Service, the interestRate field is private.");
        System.out.println("It cannot be modified directly from this class.");
        // secureConfig.interestRate = 0.99; // WOULD FAIL COMPILATION

        System.out.println("Internal methods like resetToDefault() are also private and inaccessible.");
        // secureConfig.resetToDefault(); // WOULD FAIL COMPILATION
    }
}
