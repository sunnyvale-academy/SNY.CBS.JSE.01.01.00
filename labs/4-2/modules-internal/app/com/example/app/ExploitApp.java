package com.example.app;

import com.example.crypto.VaultService;
import com.example.crypto.internal.LegacyKeyManager;

public class ExploitApp {
    public static void main(String[] args) {
        System.out.println("--- Vault Application ---");

        // Legitimate usage
        VaultService vault = new VaultService();
        vault.storeSecret("MyPassword123");

        // Illegitimate usage: Accessing an "internal" package
        // This is allowed on the classpath but forbidden on the module path
        try {
            String leakedKey = LegacyKeyManager.getMasterKey();
            System.out.println("\n[EXPLOT] Successfully leaked internal key: " + leakedKey);
        } catch (Throwable t) {
            System.out.println("\n[SECURE] Could not access internal key manager: " + t.getMessage());
        }
    }
}
