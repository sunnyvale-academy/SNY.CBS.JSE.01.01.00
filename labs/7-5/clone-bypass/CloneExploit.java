/**
 * MALICIOUS SUBCLASS: CloneExploit
 * Extends the sensitive class and implements Cloneable to enable cloning
 * attacks.
 */
public class CloneExploit extends SensitiveManager implements Cloneable {

    public CloneExploit(String data) {
        super(data);
    }

    /**
     * Overrides clone() to return a clone of this object.
     * The super.clone() call bypasses the SensitiveManager constructor checks!
     */
    @Override
    public Object clone() throws CloneNotSupportedException {
        System.out.println("Exploit: Cloning the sensitive object...");
        return super.clone();
    }

    public static SensitiveManager createClone(SensitiveManager target) {
        try {
            // If the target is an instance of CloneExploit, we can clone it.
            if (target instanceof CloneExploit) {
                return (SensitiveManager) ((CloneExploit) target).clone();
            }
        } catch (CloneNotSupportedException e) {
            System.out.println("Exploit: Clone failed! " + e.getMessage());
        }
        return null;
    }
}
