import java.io.Serializable;
import java.io.IOException;
import java.io.ObjectInputStream;

/**
 * DANGEROUS CLASS: ExploitGadget
 * Simulates a "gadget" class that is present in the classpath.
 * Attackers use such classes to execute malicious code during deserialization.
 */
public class ExploitGadget implements Serializable {
    private static final long serialVersionUID = 1L;
    private final String command;

    public ExploitGadget(String command) {
        this.command = command;
    }

    /**
     * The payload execution usually happens in readObject or a method
     * reachable from it.
     */
    private void readObject(ObjectInputStream in) throws IOException, ClassNotFoundException {
        in.defaultReadObject();

        System.out.println("\n[!] GADGET PAYLOAD EXECUTED!");
        System.out.println("[!] Simulated execution of command: " + command);
        System.out.println("[!] In a real attack, this could be 'rm -rf /' or a reverse shell.\n");
    }
}
